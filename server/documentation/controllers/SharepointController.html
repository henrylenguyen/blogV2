<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>server documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">server documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content controller">
                   <div class="content-data">





<ol class="breadcrumb">
  <li class="breadcrumb-item">Controllers</li>
  <li class="breadcrumb-item" >SharepointController</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/modules/sharepoint/sharepoint.controller.ts</code>
        </p>

            <p class="comment">
                <h3>Prefix</h3>
            </p>
            <p class="comment">
                <code>sharepoint</code>
            </p>






            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#createLibrary" >createLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#createSiteCollection" >createSiteCollection</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#deleteFile" >deleteFile</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#deleteLibrary" >deleteLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#deleteSiteCollection" >deleteSiteCollection</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getDeletedFiles" >getDeletedFiles</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getDeletedLibraries" >getDeletedLibraries</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getDocumentLibraries" >getDocumentLibraries</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getFile" >getFile</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getFilesInLibrary" >getFilesInLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getFilesInLibraryByPagination" >getFilesInLibraryByPagination</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#getSiteCollections" >getSiteCollections</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#recoverFile" >recoverFile</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#recoverLibrary" >recoverLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#softDeleteFile" >softDeleteFile</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#softDeleteLibrary" >softDeleteLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#testConnection" >testConnection</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#updateLibrary" >updateLibrary</a>
                            </li>
                            <li>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier"></span>
                                    <span class="modifier">Async</span>
                                <a href="#uploadFile" >uploadFile</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>createLibrary</b></span>
                        <a href="#createLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createLibrary(SharepointDTO: <a href="../classes/SharepointCreateDocumentLibraryDTO.html" target="_self">SharepointCreateDocumentLibraryDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Post(&#x27;site/:siteSPOId/library&#x27;)<br />@ApiOperation({summary: &#x27;Create a new document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Document library created successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br />@UsePipes(new JoiValidationPipe())<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="284"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:284</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointCreateDocumentLibraryDTO.html" target="_self" >SharepointCreateDocumentLibraryDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createSiteCollection"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>createSiteCollection</b></span>
                        <a href="#createSiteCollection"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createSiteCollection(SharepointDTO: <a href="../classes/SharepointDTO.html" target="_self">SharepointDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Post(&#x27;/create/site-collection&#x27;)<br />@ApiOperation({summary: &#x27;Create a new site collection&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;site collection created successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br />@UsePipes(new JoiValidationPipe())<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="242"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:242</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointDTO.html" target="_self" >SharepointDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteFile"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>deleteFile</b></span>
                        <a href="#deleteFile"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>deleteFile(SharepointDTO: <a href="../classes/SharepointDeleteFileDTO.html" target="_self">SharepointDeleteFileDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Delete(&#x27;delete/files&#x27;)<br />@ApiOperation({summary: &#x27;Delete a file or many files in library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;File deleted successfully&#x27;, type: SharepointFileDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="533"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:533</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointDeleteFileDTO.html" target="_self" >SharepointDeleteFileDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>deleteLibrary</b></span>
                        <a href="#deleteLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>deleteLibrary(SharepointDTO: <a href="../classes/SharepointDeleteDocumentLibraryDTO.html" target="_self">SharepointDeleteDocumentLibraryDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Delete(&#x27;/delete/document-library&#x27;)<br />@ApiOperation({summary: &#x27;Delete a document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Document library deleted successfully&#x27;, type: SharepointDeleteDocumentLibraryDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="493"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:493</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointDeleteDocumentLibraryDTO.html" target="_self" >SharepointDeleteDocumentLibraryDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="deleteSiteCollection"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>deleteSiteCollection</b></span>
                        <a href="#deleteSiteCollection"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>deleteSiteCollection(SharepointDTO: <a href="../classes/SharepointDeleteSiteCollectionDTO.html" target="_self">SharepointDeleteSiteCollectionDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Delete(&#x27;/delete/site-collection&#x27;)<br />@ApiOperation({summary: &#x27;Delete a site collection&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;site collection deleted successfully&#x27;, type: SharepointDeleteSiteCollectionDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br />@UsePipes(new JoiValidationPipe())<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="441"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:441</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointDeleteSiteCollectionDTO.html" target="_self" >SharepointDeleteSiteCollectionDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDeletedFiles"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getDeletedFiles</b></span>
                        <a href="#getDeletedFiles"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getDeletedFiles(libraryId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/:libraryId/deleted-files&#x27;)<br />@ApiOperation({summary: &#x27;Get all deleted files in library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all deleted files in library successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="210"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:210</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>libraryId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDeletedLibraries"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getDeletedLibraries</b></span>
                        <a href="#getDeletedLibraries"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getDeletedLibraries(siteSPOId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/:siteSPOId/deleted-document-libraries&#x27;)<br />@ApiOperation({summary: &#x27;Get all deleted document libraries&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all deleted document libraries successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="119"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:119</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>siteSPOId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDocumentLibraries"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getDocumentLibraries</b></span>
                        <a href="#getDocumentLibraries"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getDocumentLibraries(siteSPOId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/:siteSPOId/document-libraries&#x27;)<br />@ApiOperation({summary: &#x27;Get all document libraries&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all document libraries successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="88"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:88</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>siteSPOId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getFile"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getFile</b></span>
                        <a href="#getFile"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getFile(data: <a href="../classes/SharepointGetImageDTO.html" target="_self">SharepointGetImageDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Post(&#x27;/get-a-imame&#x27;)<br />@ApiOperation({summary: &#x27;Get a image in document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get a image in document library successfully&#x27;, type: SharepointGetImageDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="391"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:391</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/SharepointGetImageDTO.html" target="_self" >SharepointGetImageDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getFilesInLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getFilesInLibrary</b></span>
                        <a href="#getFilesInLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getFilesInLibrary(documentSPOId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/site/:siteSPOId/library/:libraryId/files&#x27;)<br />@ApiOperation({summary: &#x27;Get all files in library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all files in library successfully&#x27;, type: DocumentLibrary})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="150"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:150</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>documentSPOId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getFilesInLibraryByPagination"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getFilesInLibraryByPagination</b></span>
                        <a href="#getFilesInLibraryByPagination"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getFilesInLibraryByPagination(data: <a href="../classes/SharepointFileByPaginationDTO.html" target="_self">SharepointFileByPaginationDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/library/get-files-by-pagination&#x27;)<br />@ApiOperation({summary: &#x27;Get all files in library by pagination&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all files in library by pagination successfully&#x27;, type: DocumentLibrary})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="180"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:180</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/SharepointFileByPaginationDTO.html" target="_self" >SharepointFileByPaginationDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getSiteCollections"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>getSiteCollections</b></span>
                        <a href="#getSiteCollections"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getSiteCollections(res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;get-all/site-collections&#x27;)<br />@ApiOperation({summary: &#x27;Get all site collections&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Get all site collections successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="57"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:57</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;void&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="recoverFile"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>recoverFile</b></span>
                        <a href="#recoverFile"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>recoverFile(sharepointDTO: <a href="../classes/SharepointFileDTO.html" target="_self">SharepointFileDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Patch(&#x27;recover/file/:fileId/&#x27;)<br />@ApiOperation({summary: &#x27;Recover a file or many files in library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;File recovered successfully&#x27;, type: SharepointFileDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="751"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:751</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>sharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointFileDTO.html" target="_self" >SharepointFileDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="recoverLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>recoverLibrary</b></span>
                        <a href="#recoverLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>recoverLibrary(libraryId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Patch(&#x27;recover/library/:libraryId&#x27;)<br />@ApiOperation({summary: &#x27;Recover a document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Document library recovered successfully&#x27;, type: SharepointSoftDeleteDocumentLibraryDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="710"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:710</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>libraryId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="softDeleteFile"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>softDeleteFile</b></span>
                        <a href="#softDeleteFile"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>softDeleteFile(SharepointDTO: <a href="../classes/SharepointFileDTO.html" target="_self">SharepointFileDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Delete(&#x27;soft-delete/files&#x27;)<br />@ApiOperation({summary: &#x27;Soft delete a file in library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;File soft deleted successfully&#x27;, type: SharepointFileDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="613"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:613</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>SharepointDTO</td>
                                            <td>
                                                            <code><a href="../classes/SharepointFileDTO.html" target="_self" >SharepointFileDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="softDeleteLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>softDeleteLibrary</b></span>
                        <a href="#softDeleteLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>softDeleteLibrary(libraryId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Delete(&#x27;soft-delete/library/:libraryId&#x27;)<br />@ApiOperation({summary: &#x27;Soft delete a document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Document library soft deleted successfully&#x27;, type: SharepointSoftDeleteDocumentLibraryDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="572"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:572</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>libraryId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="testConnection"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>testConnection</b></span>
                        <a href="#testConnection"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>testConnection()</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Get(&#x27;test-connection&#x27;)<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="41"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:41</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateLibrary"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>updateLibrary</b></span>
                        <a href="#updateLibrary"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateLibrary(sharepointData: <a href="../classes/SharepointUpdateDocumentLibraryDTO.html" target="_self">SharepointUpdateDocumentLibraryDTO</a>, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Patch(&#x27;update/site/:siteName/library/:libraryName/&#x27;)<br />@ApiOperation({summary: &#x27;Update a document library&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;Document library updated successfully&#x27;, type: SharepointDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="653"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:653</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>sharepointData</td>
                                            <td>
                                                            <code><a href="../classes/SharepointUpdateDocumentLibraryDTO.html" target="_self" >SharepointUpdateDocumentLibraryDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="uploadFile"></a>
                    <span class="name">
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier"></span>
                            <span class="modifier">Async</span>
                        <span ><b>uploadFile</b></span>
                        <a href="#uploadFile"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>uploadFile(data: <a href="../classes/SharepointUploadFileDTO.html" target="_self">SharepointUploadFileDTO</a>, file: Express.Multer.File, res: Response)</code>
                </td>
            </tr>

            <tr>
                <td class="col-md-4">
                    <b>Decorators : </b>
                    <br />
                    <code>@Post(&#x27;site/:siteSPOId/library/:libraryId/upload&#x27;)<br />@ApiOperation({summary: &#x27;Upload a file&#x27;})<br />@ApiResponse({status: undefined, description: &#x27;File uploaded successfully&#x27;, type: SharepointUploadFileDTO})<br />@ApiResponse({status: undefined, description: &#x27;Validation failed&#x27;})<br />@ApiImageFile(&#x27;file&#x27;, undefined, {siteSPOId: undefined, description: undefined, documentSPOId: undefined, isForceUpdate: undefined})<br /></code>
                </td>
            </tr>

                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="345"
                                    class="link-to-prism">src/modules/sharepoint/sharepoint.controller.ts:345</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/SharepointUploadFileDTO.html" target="_self" >SharepointUploadFileDTO</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>file</td>
                                            <td>
                                                        <code>Express.Multer.File</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>res</td>
                                            <td>
                                                        <code>Response</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Body, Controller, Delete, Get, Param, Patch, Post, Res, UploadedFile, UsePipes } from &#x27;@nestjs/common&#x27;
import { ApiOperation, ApiResponse, ApiTags } from &#x27;@nestjs/swagger&#x27;
import { Response } from &#x27;express&#x27;
import sharp from &#x27;sharp&#x27;
import { ApiImageFile } from &#x27;src/common/base-api.decorator&#x27;
import httpStatus from &#x27;src/common/base.enum&#x27;
import { ParseFile } from &#x27;src/common/base.pipe&#x27;
import { IResponseData, ResponseData, ResponseMessage } from &#x27;src/common/base.reponse&#x27;
import {
  SharepointCreateDocumentLibraryDTO,
  SharepointDeleteDocumentLibraryDTO,
  SharepointDeleteFileDTO,
  SharepointDeleteSiteCollectionDTO,
  SharepointDTO,
  SharepointFileByPaginationDTO,
  SharepointFileDTO,
  SharepointGetImageDTO,
  SharepointSoftDeleteDocumentLibraryDTO,
  SharepointUpdateDocumentLibraryDTO,
  SharepointUploadFileDTO
} from &#x27;src/modules/sharepoint/sharepoint.dto&#x27;
import { DocumentLibrary } from &#x27;src/modules/sharepoint/sharepoint.model&#x27;
import {
  sharepointCreateDocumentLibrary,
  sharepointDeleteSiteCollectionValidate,
  sharepointValidate
} from &#x27;src/modules/sharepoint/sharepoint.validate&#x27;
import { UploadService } from &#x27;src/modules/upload/upload.service&#x27;
import { v4 as uuidv4 } from &#x27;uuid&#x27;
import { JoiValidationPipe } from &#x27;validation.pipe&#x27;
import { SharepointService } from &#x27;./sharepoint.service&#x27;
@Controller(&#x27;sharepoint&#x27;)
@ApiTags(&#x27;sharepoint&#x27;)
export class SharepointController {
  constructor(
    private readonly sharepointService: SharepointService,
    private readonly uploadService: UploadService
  ) {}

  @Get(&#x27;test-connection&#x27;)
  async testConnection() {
    return this.sharepointService.testConnection()
  }

  // ------------------LY TT C SITE COLLECTION---------------------
  @Get(&#x27;get-all/site-collections&#x27;)
  @ApiOperation({ summary: &#x27;Get all site collections&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all site collections successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getSiteCollections(@Res() res: Response): Promise&lt;void&gt; {
    try {
      const data &#x3D; await this.sharepointService.getSiteCollections()
      const reponseData: IResponseData&lt;SharepointDTO&gt; &#x3D; {
        data: data,
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_SITE_COLLECTIONS_SUCCESSFULLY&#x27;
      }
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_SITE_COLLECTIONS_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }
  // ------------------LY TT C DOCUMENT LIBRARY---------------------

  @Get(&#x27;get-all/:siteSPOId/document-libraries&#x27;)
  @ApiOperation({ summary: &#x27;Get all document libraries&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all document libraries successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getDocumentLibraries(@Param(&#x27;siteSPOId&#x27;) siteSPOId: string, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.getDocumentLibraries(siteSPOId)
      const reponseData: IResponseData&lt;DocumentLibrary&gt; &#x3D; {
        data,
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_DOCUMENT_LIBRARIES_SUCCESSFULLY&#x27;
      }
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_DOCUMENT_LIBRARIES_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // -----------LY TT C DOCUMENT LIBRARY  B XA MM---------------------
  @Get(&#x27;get-all/:siteSPOId/deleted-document-libraries&#x27;)
  @ApiOperation({ summary: &#x27;Get all deleted document libraries&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all deleted document libraries successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getDeletedLibraries(@Param(&#x27;siteSPOId&#x27;) siteSPOId: string, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.getDeletedLibraries(siteSPOId)
      const reponseData: IResponseData&lt;DocumentLibrary&gt; &#x3D; {
        data,
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_DELETED_DOCUMENT_LIBRARIES_SUCCESSFULLY&#x27;
      }
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_DELETED_DOCUMENT_LIBRARIES_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------LY TT C FILE TRONG LIBRARY---------------------
  @Get(&#x27;get-all/site/:siteSPOId/library/:libraryId/files&#x27;)
  @ApiOperation({ summary: &#x27;Get all files in library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all files in library successfully&#x27;,
    type: DocumentLibrary
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getFilesInLibrary(@Param(&#x27;documentSPOId&#x27;) documentSPOId: string, @Res() res: Response) {
    const response &#x3D; await this.sharepointService.getFilesInLibrary(documentSPOId)
    try {
      const reponseData &#x3D; ResponseMessage({
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_FILES_IN_LIBRARY_SUCCESSFULLY&#x27;,
        data: response
      })
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData &#x3D; ResponseMessage({
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_FILES_IN_LIBRARY_FAILED - ${error.message}&#x60;
      })
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // --------LY TT C FILE TRONG LIBRARY THEO PHN TRANG---------------------
  @Get(&#x27;get-all/library/get-files-by-pagination&#x27;)
  @ApiOperation({ summary: &#x27;Get all files in library by pagination&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all files in library by pagination successfully&#x27;,
    type: DocumentLibrary
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getFilesInLibraryByPagination(@Body() data: SharepointFileByPaginationDTO, @Res() res: Response) {
    const response &#x3D; await this.sharepointService.getFilesInLibraryByPagination(data)
    try {
      const reponseData &#x3D; ResponseMessage({
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_FILES_IN_LIBRARY_SUCCESSFULLY&#x27;,
        data: response
      })
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData &#x3D; ResponseMessage({
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_FILES_IN_LIBRARY_FAILED - ${error.message}&#x60;
      })
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------LY TT C FILE  B XA MM TRONG LIBRARY---------------------
  @Get(&#x27;get-all/:libraryId/deleted-files&#x27;)
  @ApiOperation({ summary: &#x27;Get all deleted files in library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get all deleted files in library successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getDeletedFiles(@Param(&#x27;libraryId&#x27;) libraryId: string, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.getDeletedFilesInLibrary(libraryId)
      const reponseData: IResponseData&lt;DocumentLibrary&gt; &#x3D; {
        data,
        statusCode: httpStatus.SUCCESS,
        message: &#x27;GET_DELETED_FILES_IN_LIBRARY_SUCCESSFULLY&#x27;
      }
      res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_DELETED_FILES_IN_LIBRARY_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------TO MI SITE COLLECTION---------------------
  @Post(&#x27;/create/site-collection&#x27;)
  @ApiOperation({ summary: &#x27;Create a new site collection&#x27; })
  @ApiResponse({
    status: httpStatus.CREATED,
    description: &#x27;site collection created successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  @UsePipes(new JoiValidationPipe(sharepointValidate(&#x27;site collection&#x27;)))
  async createSiteCollection(@Body() SharepointDTO: SharepointDTO, @Res() res: Response): Promise&lt;void&gt; {
    try {
      const data &#x3D; await this.sharepointService.createSiteCollection(SharepointDTO)
      if (!data) {
        const responseData &#x3D; ResponseMessage({
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x27;SITE_COLLECTION_ALREADY_EXIST&#x27;
        })

        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else {
        const reponseData: IResponseData&lt;SharepointDTO&gt; &#x3D; {
          data: data,
          statusCode: httpStatus.CREATED,
          message: &#x27;SITE_COLLECTION_CREATED_SUCCESSFULLY&#x27;
        }
        res.status(httpStatus.CREATED).json(new ResponseData(reponseData))
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;INTERNAL_SERVER_ERROR ${error.message}&#x60;
      }
      res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
    }
  }

  // ------------------TO MI DOCUMENT LIBRARY---------------------

  @Post(&#x27;site/:siteSPOId/library&#x27;)
  @ApiOperation({ summary: &#x27;Create a new document library&#x27; })
  @ApiResponse({
    status: httpStatus.CREATED,
    description: &#x27;Document library created successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  @UsePipes(new JoiValidationPipe(sharepointCreateDocumentLibrary))
  async createLibrary(@Body() SharepointDTO: SharepointCreateDocumentLibraryDTO, @Res() res: Response): Promise&lt;void&gt; {
    try {
      const result &#x3D; await this.sharepointService.createLibrary(SharepointDTO)
      if (result) {
        const reponseData: IResponseData&lt;SharepointDTO&gt; &#x3D; {
          data: result,
          statusCode: httpStatus.CREATED,
          message: &#x27;LIBRARY_CREATED_SUCCESSFULLY&#x27;
        }
        res.status(httpStatus.CREATED).json(new ResponseData(reponseData))
      } else {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x60;SITE_ID_NOT_FOUND&#x60;
        }
        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      }
    } catch (error) {
      if (error.statusCode &#x3D;&#x3D;&#x3D; httpStatus.BAD_REQUEST) {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x60;LIBRARY_CREATED_FAILED - ${error.message}&#x60;
        }
        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else if (error.statusCode &#x3D;&#x3D;&#x3D; httpStatus.ALREADY_EXIST) {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.ALREADY_EXIST,
          message: &#x60;LIBRARY_CREATED_FAILED - ${error.message}&#x60;
        }
        res.status(httpStatus.ALREADY_EXIST).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.INTERNAL_SERVER_ERROR,
          message: &#x60;INTERNAL_SERVER_ERROR - ${error.message}&#x60;
        }
        res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
      }
    }
  }

  @Post(&#x27;site/:siteSPOId/library/:libraryId/upload&#x27;)
  @ApiOperation({ summary: &#x27;Upload a file&#x27; })
  @ApiResponse({
    status: httpStatus.CREATED,
    description: &#x27;File uploaded successfully&#x27;,
    type: SharepointUploadFileDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  @ApiImageFile(&#x27;file&#x27;, true, {
    siteSPOId: { type: &#x27;string&#x27;, example: &#x27;&#x27;, required: true },
    description: { type: &#x27;string&#x27;, example: &#x27;image about ...&#x27;, required: true },
    documentSPOId: { type: &#x27;string&#x27;, example: &#x27;&#x27;, required: true },
    isForceUpdate: { type: &#x27;boolean&#x27;, required: false }
  })
  async uploadFile(
    @Body() data: SharepointUploadFileDTO,
    @UploadedFile(ParseFile) file: Express.Multer.File,
    @Res() res: Response
  ) {
    const isValid &#x3D; await this.uploadService.uploadFile(file)
    if (!isValid) {
      const responseData &#x3D; ResponseMessage({
        statusCode: httpStatus.BAD_REQUEST,
        message: &#x27;INVALID_FILE_TYPE&#x27;
      })

      res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
    } else {
      try {
        const result &#x3D; await this.sharepointService.uploadFile(data, file)
        if (result) {
          const responseData &#x3D; ResponseMessage({
            statusCode: httpStatus.CREATED,
            message: &#x27;UPLOAD_FILE_SUCCESSFULLY&#x27;,
            data: result
          })
          res.status(httpStatus.CREATED).json(new ResponseData(responseData))
        }
      } catch (error) {
        const responseData &#x3D; ResponseMessage({
          statusCode: httpStatus.INTERNAL_SERVER_ERROR,
          message: &#x60;UPLOAD_FILE_FAILED - ${error.message}&#x60;
        })

        res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
      }
    }
  }

  @Post(&#x27;/get-a-imame&#x27;)
  @ApiOperation({ summary: &#x27;Get a image in document library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Get a image in document library successfully&#x27;,
    type: SharepointGetImageDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async getFile(@Body() data: SharepointGetImageDTO, @Res() res: Response) {
    try {
      const response &#x3D; await this.sharepointService.getImageInLibrary(data)
      if (response) {
        const webpImageBuffer &#x3D; await sharp(response)
          .webp({ quality: 80 }) // Chuyn i sang nh dng WebP vi cht lng 80%
          .toBuffer()
        // res.set({
        //   &#x27;Content-Type&#x27;: &#x27;application/octet-stream&#x27;, // S dng loi MIME ph hp, v d: &#x27;image/jpeg&#x27;
        //   &#x27;Content-Disposition&#x27;: &#x27;attachment; filename&#x3D;&quot;image.png&quot;&#x27; // Ty chn: gi  tn file ti v
        // })
        const uniqueFileName &#x3D; &#x60;${uuidv4()}.webp&#x60;
        res.set({
          &#x27;Content-Type&#x27;: &#x27;image/webp&#x27;, // nh dng MIME cho nh WebP
          &#x27;Cache-Control&#x27;: &#x27;public, max-age&#x3D;31536000&#x27;, // Lu trong b nh cache ti a 1 nm
          ETag: &#x27;12345&#x27;, // ETag  kim tra thay i ni dung
          &#x27;Content-Disposition&#x27;: &#x60;inline; filename&#x3D;&quot;${uniqueFileName}&quot;&#x60; //  xut tn file ng
        })
        res.status(httpStatus.SUCCESS).send(Buffer.from(webpImageBuffer))
      } else {
        const responseData &#x3D; ResponseMessage({
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x27;ID_NOT_FOUND&#x27;
        })

        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      }
    } catch (error) {
      const responseData &#x3D; ResponseMessage({
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;GET_IMAGE_FAILED - ${error.message}&#x60;
      })

      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------XA SITE COLLECTION---------------------
  @Delete(&#x27;/delete/site-collection&#x27;)
  @ApiOperation({ summary: &#x27;Delete a site collection&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;site collection deleted successfully&#x27;,
    type: SharepointDeleteSiteCollectionDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  @UsePipes(new JoiValidationPipe(sharepointDeleteSiteCollectionValidate()))
  async deleteSiteCollection(
    @Body() SharepointDTO: SharepointDeleteSiteCollectionDTO,
    @Res() res: Response
  ): Promise&lt;void&gt; {
    try {
      const data &#x3D; await this.sharepointService.deleteSiteCollection(SharepointDTO)
      if (data.error) {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x60;SITE_COLLECTION_DELETED_FAILED - ${data.error.message.value}&#x60;
        }

        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else if (!data) {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x60;SITE_COLLECTION_NOT_FOUND&#x60;
        }

        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else {
        const reponseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;SITE_COLLECTION_DELETED_SUCCESSFULLY&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;INTERNAL_SERVER_ERROR ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------XA DOCUMENT LIBRARY---------------------
  @Delete(&#x27;/delete/document-library&#x27;)
  @ApiOperation({ summary: &#x27;Delete a document library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Document library deleted successfully&#x27;,
    type: SharepointDeleteDocumentLibraryDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async deleteLibrary(@Body() SharepointDTO: SharepointDeleteDocumentLibraryDTO, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.deleteLibrary(SharepointDTO)
      // if (data?.error) {
      //   const responseData: IResponseData&lt;null&gt; &#x3D; {
      //     data: null,
      //     statusCode: httpStatus.BAD_REQUEST,
      //     message: &#x60;LIBRARY_DELETED_FAILED - ${data.error.message.value}&#x60;
      //   }
      //   res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      // } else {
      //   const reponseData: IResponseData&lt;SharepointDTO&gt; &#x3D; {
      //     data: null,
      //     statusCode: httpStatus.SUCCESS,
      //     message: &#x27;LIBRARY_DELETED_SUCCESSFULLY&#x27;
      //   }
      //   res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
      // }
    } catch (error) {
      console.log(&#x27;error:&#x27;, error)
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;LIBRARY_DELETED_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }
  // ------------------XA VNH VIN FILE TRONG LIBRARY---------------------
  @Delete(&#x27;delete/files&#x27;)
  @ApiOperation({ summary: &#x27;Delete a file or many files in library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;File deleted successfully&#x27;,
    type: SharepointFileDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async deleteFile(@Body() SharepointDTO: SharepointDeleteFileDTO, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.deleteFilePermanently(SharepointDTO)
      if (!data) {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: false,
          statusCode: httpStatus.NOT_FOUND,
          message: &#x27;ID_NOT_FOUND&#x27;
        }
        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: true,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;DELETE_FILE_SUCCESS&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(responseData))
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;DELETE_FILE_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }
  // ------------------XA MM DOCUMENT LIBRARY---------------------
  @Delete(&#x27;soft-delete/library/:libraryId&#x27;)
  @ApiOperation({ summary: &#x27;Soft delete a document library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Document library soft deleted successfully&#x27;,
    type: SharepointSoftDeleteDocumentLibraryDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async softDeleteLibrary(@Param(&#x27;libraryId&#x27;) libraryId: string, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.softDeleteLibrary(libraryId)
      if (!data) {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: false,
          statusCode: httpStatus.NOT_FOUND,
          message: &#x27;ID_NOT_FOUND&#x27;
        }
        res.status(404).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: true,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;SOFT_DELETE_DOCUMENT_LIBRARY_SUCCESS&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(responseData))
      }
    } catch (error) {
      console.log(&#x27;error:&#x27;, error)
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;SOFT_DELETED_DOCUMENT_LIBRARY_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------XA MM FILE TRONG LIBRARY---------------------
  @Delete(&#x27;soft-delete/files&#x27;)
  @ApiOperation({ summary: &#x27;Soft delete a file in library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;File soft deleted successfully&#x27;,
    type: SharepointFileDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async softDeleteFile(@Body() SharepointDTO: SharepointFileDTO, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.softDeleteFileInLibrary(SharepointDTO)
      if (!data) {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: false,
          statusCode: httpStatus.NOT_FOUND,
          message: &#x27;ID_NOT_FOUND&#x27;
        }
        res.status(404).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: true,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;SOFT_DELETE_FILE_SUCCESS&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(responseData))
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;SOFT_DELETED_FILE_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------CP NHT DOCUMENT LIBRARY---------------------
  @Patch(&#x27;update/site/:siteName/library/:libraryName/&#x27;)
  @ApiOperation({ summary: &#x27;Update a document library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Document library updated successfully&#x27;,
    type: SharepointDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async updateLibrary(@Body() sharepointData: SharepointUpdateDocumentLibraryDTO, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.updateLibrary(sharepointData)
      console.log(&#x27;data:&#x27;, data)
      if (data?.error) {
        const responseData: IResponseData&lt;null&gt; &#x3D; {
          data: null,
          statusCode: httpStatus.BAD_REQUEST,
          message: &#x60;LIBRARY_UPDATED_FAILED - ${data.error.message.value}&#x60;
        }
        res.status(httpStatus.BAD_REQUEST).json(new ResponseData(responseData))
      } else {
        if (data) {
          const reponseData: IResponseData&lt;DocumentLibrary&gt; &#x3D; {
            data,
            statusCode: httpStatus.SUCCESS,
            message: &#x27;LIBRARY_UPDATED_SUCCESSFULLY&#x27;
          }
          res.status(httpStatus.SUCCESS).json(new ResponseData(reponseData))
        } else if (data &#x3D;&#x3D;&#x3D; null) {
          const responseData: IResponseData&lt;null&gt; &#x3D; {
            data: null,
            statusCode: httpStatus.NOT_FOUND,
            message: &#x60;LIBRARY_UPDATED_FAILED - LIBRARY_OLD_NAME_NOT_FOUND&#x60;
          }
          res.status(httpStatus.NOT_FOUND).json(new ResponseData(responseData))
        } else {
          const responseData: IResponseData&lt;null&gt; &#x3D; {
            data: null,
            statusCode: httpStatus.ALREADY_EXIST,
            message: &#x60;LIBRARY_NAME_ALREADY_EXIST&#x60;
          }
          res.status(httpStatus.ALREADY_EXIST).json(new ResponseData(responseData))
        }
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;LIBRARY_UPDATED_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------KHI PHC DOCUMENT LIBRARY---------------------
  @Patch(&#x27;recover/library/:libraryId&#x27;)
  @ApiOperation({ summary: &#x27;Recover a document library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;Document library recovered successfully&#x27;,
    type: SharepointSoftDeleteDocumentLibraryDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async recoverLibrary(@Param(&#x27;libraryId&#x27;) libraryId: string, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.recoverLibrary(libraryId)
      if (!data) {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: false,
          statusCode: httpStatus.NOT_FOUND,
          message: &#x27;ID_NOT_FOUND&#x27;
        }
        res.status(404).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: true,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;RECOVER_DOCUMENT_LIBRARY_SUCCESS&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(responseData))
      }
    } catch (error) {
      console.log(&#x27;error:&#x27;, error)
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;RECOVER_DOCUMENT_LIBRARY_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }

  // ------------------KHI PHC FILE TRONG LIBRARY---------------------
  @Patch(&#x27;recover/file/:fileId/&#x27;)
  @ApiOperation({ summary: &#x27;Recover a file or many files in library&#x27; })
  @ApiResponse({
    status: httpStatus.SUCCESS,
    description: &#x27;File recovered successfully&#x27;,
    type: SharepointFileDTO
  })
  @ApiResponse({
    status: httpStatus.BAD_REQUEST,
    description: &#x27;Validation failed&#x27;
  })
  async recoverFile(@Body() sharepointDTO: SharepointFileDTO, @Res() res: Response) {
    try {
      const data &#x3D; await this.sharepointService.recoverFileInLibrary(sharepointDTO)
      if (!data) {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: false,
          statusCode: httpStatus.NOT_FOUND,
          message: &#x27;ID_NOT_FOUND&#x27;
        }
        res.status(404).json(new ResponseData(responseData))
      } else {
        const responseData: IResponseData&lt;boolean&gt; &#x3D; {
          data: true,
          statusCode: httpStatus.SUCCESS,
          message: &#x27;RECOVER_FILE_SUCCESS&#x27;
        }
        res.status(httpStatus.SUCCESS).json(new ResponseData(responseData))
      }
    } catch (error) {
      const responseData: IResponseData&lt;null&gt; &#x3D; {
        data: null,
        statusCode: httpStatus.INTERNAL_SERVER_ERROR,
        message: &#x60;RECOVER_FILE_FAILED - ${error.message}&#x60;
      }
      res.status(httpStatus.INTERNAL_SERVER_ERROR).json(new ResponseData(responseData))
    }
  }
}
</code></pre>
    </div>
</div>
















                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'controller';
            var COMPODOC_CURRENT_PAGE_URL = 'SharepointController.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
